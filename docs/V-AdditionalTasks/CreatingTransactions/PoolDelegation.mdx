---
title: "Delegating to a Stake Pool"
sidebar_label: "Delegating to a Stake Pool"
slug: /PoolDelegation
hide_title: false
hide_table_of_contents: false
sidebar_position: 10
description: ""
---

import React from 'react';

import useBaseUrl from '@docusaurus/useBaseUrl';

import TestnetNote from '@site/src/components/TestnetNote.js';

import CodeBlock from '@theme/CodeBlock';
import saveParameters from '!!raw-loader!/txt/saveParameters.sh';
import queryTip from '!!raw-loader!/txt/queryTip.sh';
import tallyUTXOs from '!!raw-loader!/txt/tallyUTXOs.sh';
import calculateFee from '!!raw-loader!/txt/calculateFee.sh';
import signTransaction from '!!raw-loader!/txt/signTransaction.sh';
import submitTransaction from '!!raw-loader!/txt/submitTransaction.sh';

export function HTMLContent() {

  // Replace placeholders in the imported calculateFee component with values
  var calculateFeePoolDelegation = calculateFee.replace("{{witness-count}}", "2");

  // Replace placeholder in the imported signTransaction component with values
  var signTransactionPoolDelegation = signTransaction.replace("{{signing-key-files}}", "--signing-key-file payment.skey \\\n  --signing-key-file stake.skey \\\n  ");

  return (
    <div>

      {/* INSERT HTML HERE */}

      <p><a href="/RegisteringPool">Registering a Stake Pool</a> involves submitting a stake delegation certificate to the Cardano blockchain ledger. However, using Cardano CLI you can also delegate a wallet address to an existing stake pool without registering a stake pool.</p>

      <p>Delegating a wallet address to a stake pool involves:</p>

      <ol>
        <li>Selecting the wallet that you want to use</li>
        <li>Ensuring that the payment address is funded</li>
        <li>Ensuring that the stake address is registered</li>
        <li>Generating a stake delegation certificate</li>
        <li>Submitting the stake delegation certificate to the Cardano blockchain ledger</li>
      </ol>

      <TestnetNote />

      <p class="pi">To delegate a wallet address to an existing stake pool:</p>

      <ol>
        <li>If you need to create a new wallet address for delegating to an existing stake pool, then follow the procedures for <a href="/CreatingWallet">Creating a Wallet</a>, and then <a href="/CreatingWallet#FundingAddress">Funding Your Payment Address</a>.
          <table class="box">
            <tbody>
              <tr>
                <td class="boxLabel"><p class="boxLabel">Important<br /><img src={useBaseUrl('img/BoxImportant.png')} alt="Important" /></p></td>
                <td class="boxText"><p class="boxText">Do NOT overwrite existing key, address or certificate files. Throughout the procedure, ensure that you use the key, address and certificate files associated with the wallet that you want to delegate to a stake pool.</p></td>
              </tr>
            </tbody>
          </table>
        </li>
        <li>If you are delegating the wallet address to a stake pool for the first time, then follow the procedure for <a href="/RegisteringAddress">Registering a Stake Address</a>.</li>
        <li>To generate a stake delegation certificate, using a terminal window on the block-producing node in your stake pool configuration, type the following command where <code>&lt;StakePoolID&gt;</code> is the unique ID for the stake pool where you want to delegate using hexadecimal or Bech32 format:
          <CodeBlock language="bash">
            {`cardano-cli conway stake-address stake-delegation-certificate \\
  --stake-verification-key-file $NODE_HOME/stake.vkey \\
  --stake-pool-id <StakePoolID> \\
  --out-file $NODE_HOME/deleg.cert`}
          </CodeBlock>          
        </li>
        <li>On the computer hosting the block-producing node in your stake pool configuration, when the local copy of the Cardano blockchain ledger is fully synchronized with the network, using a terminal window type the following commands to save protocol parameters in a file using JSON format:
          <CodeBlock language="bash">
            {saveParameters}
          </CodeBlock>
        </li>
        <li>To query the slot number of the current tip of the ledger, type:
          <CodeBlock language="bash">
            {queryTip}
          </CodeBlock>
        </li>
        <li>To retrieve the UTXOs available for your payment address and calculate the balance, type:
          <CodeBlock language="bash">
            {tallyUTXOs}
          </CodeBlock>
        </li>
        <li>To build a draft transaction for calculating the transaction fee, type:
          <CodeBlock language="bash">
            {`cardano-cli conway transaction build-raw \\
  $\{tx_in\} \\
  --tx-out $(cat $NODE_HOME/payment.addr)+$(( $\{total_balance\} - 200000 )) \\
  --invalid-hereafter $(( $\{currentSlot\} + 10000 )) \\
  --fee 200000 \\
  --certificate-file $NODE_HOME/deleg.cert \\
  --out-file $NODE_HOME/tx.tmp`}
          </CodeBlock>
        </li>
        <li>To calculate the fee for the transaction, type:
          <CodeBlock language="bash">
            {calculateFeePoolDelegation}
          </CodeBlock>
        </li>
        <li>To calculate change from the transaction, type:
          <CodeBlock language="bash">
            {`txOut=$(( $\{total_balance\} - $\{fee\} ))
echo Change: $\{txOut\}`}
          </CodeBlock>
        </li>
        <li>To build the transaction, type:
          <CodeBlock language="bash">
            {`cardano-cli conway transaction build-raw \\
  $\{tx_in\} \\
  --tx-out $(cat $NODE_HOME/payment.addr)+$\{txOut\} \\
  --invalid-hereafter $(( $\{currentSlot\} + 10000 )) \\
  --fee $\{fee\} \\
  --certificate-file $NODE_HOME/deleg.cert \\
  --out-file $NODE_HOME/tx.raw`}
          </CodeBlock>
        </li>
        <li>Copy the <code>tx.raw</code> file that you created in step 10 to the <code>$NODE_HOME</code> folder on your air-gapped, offline computer, and then using a terminal window type the following commands to sign the transaction:
          <CodeBlock language="bash">
            {signTransactionPoolDelegation}
          </CodeBlock>
        </li>
        <li>Copy the <code>tx.signed</code> file that you created in step 11 to the <code>$NODE_HOME</code> folder on the block-producing node, and then using a terminal window type the following command to submit the transaction to the network:
          <CodeBlock language="bash">
            {submitTransaction}
          </CodeBlock>
        </li>
      </ol>

      <p>To verify that the stake delegation is successful, wait a few moments for the transaction to complete, then using a <a href="https://explorer.cardano.org/" target="_blank">blockchain explorer</a> find the pool where you delegated, and then find the stake address associated with the delegation in the list of delegators.</p>

    </div>
  );
}

<HTMLContent />

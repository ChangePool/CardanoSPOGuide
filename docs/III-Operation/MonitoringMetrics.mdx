---
title: "Monitoring Metrics"
sidebar_label: "Monitoring Metrics"
slug: /MonitoringMetrics
hide_title: false
hide_table_of_contents: true
sidebar_position: 10
description: ""
---

import React from 'react';

export function HTMLContent() {
  return (
    <div>

      {/* INSERT HTML HERE */}

      -----

      <p>Use a relay (and previewnode) to create the content (in the Guide, the block producer is not configured yet).</p>

      <p>Document using EKG only (whatever is enabled by default in CN v10.5.1 when Cardano Tracer is disabled, based on the configuration files; do NOT explain Prometheus yet because the Prometheus endpoint moves to Cardano Tracer and that would involve more work to update later... updating only content for EKG would probably be relatively easy when the old tracing system is deprecated). Explain the hasEKG option in config.json pertaining to EKG.</p>

      -----

      <p>Cardano Node trace objects, which add log entries, may also produce metrics for monitoring node status. By default, Cardano Node enables a proprietary endpoint named EKG, as well as a <a href="https://prometheus.io/" target="_blank">Prometheus</a> endpoint, so that you can to display current metrics using a Web browser, or query current metrics using a terminal window or Bash script.</p>

      <h2>Displaying Metrics Using a Web Browser</h2>

      <p class="pi">To display current metrics for the instance of Cardano Node running on the local computer using a Web browser:</p>
      
      <ul class="ss">
        <li>To display metrics using the EKG endpoint, visit <code>http://localhost:12788/</code> To display values, you may need to scroll right.
          <center><strong>OR</strong></center>
          To display metrics using the Prometheus endpoint, visit <code>http://localhost:12798/</code>
        </li>
      </ul>

      <table class="box">
        <tbody>
          <tr>
            <td class="boxLabel"><p class="boxLabel">Challenge<br /><img src="img/BoxChallenge.png" alt="Challenge" /></p></td>
            <td class="boxText"><p class="boxText">Using the following options in the <code>$&#123;NODE_HOME&#125;/config.json</code> or <code>$&#123;NODE_HOME&#125;/config-bp.json</code> file, you can set the IP address and port where the EKG and Prometheus endpoints listen. For options that you modify in the configuration file to take effect, you need to restart Cardano Node:<pre>
              "hasEKG": [<br />
              &nbsp;&nbsp;"127.0.0.1",<br />
              &nbsp;&nbsp;12788<br />
              ],<br />
              "hasPrometheus": [<br />
              &nbsp;&nbsp;"127.0.0.1",<br />
              &nbsp;&nbsp;12798<br />
              ]
            </pre></p></td>
          </tr>
        </tbody>
      </table>

      <h2>Useful Metrics</h2>

      <p>As a starting point to monitor an instance of Cardano Node, you may find the following EKG metrics most useful:</p>

      <ul>
        <li><b>cardano.node.metrics.epoch.int</b>—The epoch number of the tip of the local copy of the Cardano blockchain ledger. In the Cardano ecosystem, each epoch is five days in duration.</li>
        <li><b>cardano.node.metrics.slotInEpoch.int</b>—The slot number of the tip of the local copy of the Cardano blockchain ledger since the beginning of the current epoch. A slot occurs every second. Therefore, each epoch is comprised of 432,000 slots.
          <table class="box">
            <tbody>
              <tr>
                <td class="boxLabel"><p class="boxLabel">Important<br /><img src="img/BoxImportant.png" alt="Important" /></p></td>
                <td class="boxText"><p class="boxText">For the current epoch and relative slot number of the Cardano network, see a <a href="https://explorer.cardano.org/" target="_blank">blockchain explorer</a>. When the epoch and slot number of a local copy of the ledger match the current epoch and slot number of the network, then the local Cardano Node instance is synchronized.</p></td>
              </tr>
            </tbody>
          </table>
        </li>
        {/* <!-- <li><b>cardano.node.metrics.slotNum.int</b>—The slot number of the tip of the local copy of the Cardano blockchain since the start of the ledger</li> --> */}
        <li><b>cardano.node.metrics.blockNum.int</b>—The number of the most recent block produced since the start of the ledger, also referred to as the block height. Generally, the Cardano protocol produces a block approximately every 20 seconds.</li>
        <li><b>cardano.node.metrics.connectionManager.incomingConns</b>—The total number of remote Cardano Node instances—network peers—populating the network using blocks from the local copy of the blockchain ledger</li>
        <li><b>cardano.node.metrics.connectionManager.outgoingConns</b>—The total number of network peers that the local Cardano Node instance is using to populate the local copy of the blockchain ledger </li>
        <li><b>cardano.node.metrics.served.block.count.int</b>—The number of blocks fetched from the local copy of the blockchain ledger by incoming peers</li>
        <li><b>cardano.node.metrics.blockfetchclient.blockdelay.cdfOne</b>—The percentage of blocks that the local Cardano Node instance currently propagates within one second of production</li>
        <li><b>cardano.node.metrics.blockfetchclient.blockdelay.cdfThree</b>—The percentage of blocks that the local Cardano Node instance currently propagates within three seconds of production</li>
        <li><b>cardano.node.metrics.blockfetchclient.blockdelay.cdfFive</b>—The percentage of blocks that the local Cardano Node instance currently propagates within five seconds of production</li>
        <li><b>cardano.node.metrics.RTS.gcHeapBytes.int</b>—In bytes, the amount of memory currently allocated to the local instance of Cardano Node</li>
        <li><b>cardano.node.metrics.RTS.gcLiveBytes.int</b>—In bytes, the amount of data in memory currently potentially usable by the local instance of Cardano Node</li>
      </ul>

      <table class="box">
        <tbody>
          <tr>
            <td class="boxLabel"><p class="boxLabel">Note<br /><img src="img/BoxNote.png" alt="Note" /></p></td>
            <td class="boxText"><p class="boxText">To convert the name of an EKG metric to the corresponding Prometheus metric, replace period (<code>.</code>) characters with underscore (<code>_</code>) characters.</p></td>
          </tr>
        </tbody>
      </table>

      <h2>Querying Metrics Using a Terminal Window</h2>

      <p>When querying the EKG endpoint using a terminal window, retrieve results using JavaScript Object Notation (JSON) format, and then parse the JSON output using <a href="https://jqlang.org/" target="_blank">jq</a></p>

      <p class="pi">To query current metrics for the local instance of Cardano Node using a terminal window:</p>

      <ul class="ss">
        <li>To query metrics using the EKG endpoint, type <code>curl -s -H 'Accept: application/json' http://localhost:12788/ | jq .</code>
        <center><strong>OR</strong></center>
        To query metrics using the Prometheus endpoint, type <code>curl http://localhost:12798/metrics</code></li>
      </ul>

      <table class="box">
        <tbody>
          <tr>
            <td class="boxLabel"><p class="boxLabel">Note<br /><img src="img/BoxNote.png" alt="Note" /></p></td>
            <td class="boxText"><p class="boxText">If you changed the IP address or port where the EKG or Prometheus endpoints listen, then update the URL in the <code>curl</code> command accordingly.</p></td>
          </tr>
        </tbody>
      </table>

      <h2>Incorporating Metrics in Bash Scripts</h2>





      <code>curl -s -H 'Accept: application/json' http://localhost:12788/ | jq -r '.cardano.node.metrics.blockfetchclient.blockdelay.cdfOne.val'</code>


      <h2>Conclusion</h2>

      <p>Now you know how to create a dashboard for monitoring your Cardano stake pool.</p>

      <p>For some third-party dashboards available in the Cardano community, see <a href="/Community">Appendix C: Community Projects</a>.</p>

    </div>
  );
}

<HTMLContent />


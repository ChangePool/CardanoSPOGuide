---
title: "Calculating Slot Leadership"
sidebar_label: "Calculating Slot Leadership"
slug: /CalculatingSlotLeadership
hide_title: false
hide_table_of_contents: true
sidebar_position: 45
description: ""
---

import React from 'react';

import TestnetNote from '@site/src/components/TestnetNote.js';

import CodeBlock from '@theme/CodeBlock';

import calculateLeadership from '!!raw-loader!/txt/calculateLeadership.sh';

export function HTMLContent() {
  return (
    <div>

      {/* INSERT HTML HERE */}

      <table class="box">
        <tbody>
          <tr>
            <td class="boxLabel"><p class="boxLabel">Challenge<br /><img src="img/BoxChallenge.png" alt="Challenge" /></p></td>
            <td class="boxText"><p class="boxText">If you operate a stake pool in a Testnet environment, then use the <a href="https://docs.cardano.org/cardano-testnets/tools/faucet" target="_blank">Testnets Faucet</a> to receive a delegation to the pool. Receiving a delegation ensures that the pool is elected to produce blocks regularly, facilitating development and testing.</p></td>
          </tr>
        </tbody>
      </table>

      <p>As a stake pool operator, you aim to keep the stake pool that you operate online at all times. However, knowing in advance when the stake pool is elected to produce blocks allows you to schedule required maintenance, for example, without missing an opportunity to produce a block.</p>

      <p>Using Cardano CLI, you can query the slot numbers and Coordinated Universal Times (UTCs) when a stake pool that you operate is elected to produce blocks in the current epoch. In the Pre-production Testnet and Mainnet environments, within 36 hours of the next epoch starting you can also query the slot numbers and times when the stake pool is elected to produce blocks in the next epoch. In the Preview Testnet environment, you can query the slot leadership schedule for the next epoch within 6 hours of the next epoch starting.</p>

      <p><i>Figure 1</i> illustrates how the Cardano protocol shares with stake pool operators the slot leadership schedule for block production, as well as how stake pools prepare blocks.</p>

      <figure>
        <img src="img/BlockProductionProcess.png" />
        <figcaption>Figure 1 Cardano Block Production Process</figcaption>
      </figure>

      <TestnetNote />

      <p class="pi">To query the slot numbers and times when a stake pool you operate is elected to produce blocks in the current epoch:</p>
      
      <ul class="ss">
        <li>Using a terminal window on the block-producing node, type:
          <CodeBlock language="bash">
            {`cardano-cli conway query leadership-schedule --output-json \\
  --cardano-mode \\
  --mainnet \\
  --genesis $NODE_HOME/shelley-genesis.json \\
  --stake-pool-id $(cat $NODE_HOME/stakepoolid-bech32.txt) \\
  --vrf-signing-key-file $NODE_HOME/vrf.skey \\
  --current`}
          </CodeBlock>
        </li>
      </ul>

      <table class="box">
        <tbody>
          <tr>
            <td class="boxLabel"><p class="boxLabel">Note<br /><img src="img/BoxNote.png" alt="Note" /></p></td>
            <td class="boxText"><p class="boxText">Depending on available computing resources, the <code>query leadership-schedule</code> command may run for a few minutes prior to displaying results.</p></td>
          </tr>
        </tbody>
      </table>

      <p class="pi">To query the slot numbers and times when a stake pool you operate is elected to produce blocks in the next epoch:</p>
      
      <ul class="ss">
        <li>Using a terminal window on the block-producing node, type the following command when the current epoch is more than 70 percent complete:
          <CodeBlock language="bash">
            {`cardano-cli conway query leadership-schedule --output-json \\
  --cardano-mode \\
  --mainnet \\
  --genesis $NODE_HOME/shelley-genesis.json \\
  --stake-pool-id $(cat $NODE_HOME/stakepoolid-bech32.txt) \\
  --vrf-signing-key-file $NODE_HOME/vrf.skey \\
  --next`}
          </CodeBlock>
        </li>
      </ul>

      <table class="box">
        <tbody>
          <tr>
            <td class="boxLabel"><p class="boxLabel">Important<br /><img src="img/BoxImportant.png" alt="Important" /></p></td>
            <td class="boxText"><p class="boxText">Do NOT share the slot leadership schedule for the stake pool that you operate on Mainnet publicly.</p></td>
          </tr>
        </tbody>
      </table>

      <p>The following example shows you the JSON output format of a <code>query leadership-schedule</code> command:</p>

      <CodeBlock language="json">
        {`[
    {
        "slotNumber": 94264420,
        "slotTime": "2025-10-20T00:33:40Z"
    },
    {
        "slotNumber": 94266557,
        "slotTime": "2025-10-20T01:09:17Z"
    },
    {
        "slotNumber": 94276787,
        "slotTime": "2025-10-20T03:59:47Z"
    },
    {
        "slotNumber": 94277515,
        "slotTime": "2025-10-20T04:11:55Z"
    },
    {
        "slotNumber": 94318072,
        "slotTime": "2025-10-20T15:27:52Z"
    }
]`}
      </CodeBlock>

      <h1>Automating Slot Leadership Calculation</h1>

      <p>The following script offers an example showing how you can automate the process of calculating slot leadership for the stake pool that you operate.</p>

      <p>The script uses the <code>slotInEpoch</code> EKG metric to test if the current epoch is more than 70 percent complete. If needed, the script waits until the leadership schedule for the next epoch is available. When the leadership schedule is available, the script queries the slot leadership schedule to retrieve the slot numbers and times when the stake pool you operate is scheduled to produce blocks in the next epoch, and then saves the data in a new text file using JSON format.</p>

      <p>Running the script as a <code>systemd</code> service that starts when the computer boots ensures that up-to-date slot leadership data is always available for you, the stake pool operator.</p>

      <table class="box">
        <tbody>
          <tr>
            <td class="boxLabel"><p class="boxLabel">Note<br /><img src="img/BoxNote.png" alt="Note" /></p></td>
            <td class="boxText"><p class="boxText">You must query the slot leadership schedule using the block-producing node in your stake pool configuration.</p></td>
          </tr>
        </tbody>
      </table>

      <p class="pi">To create a Bash script that queries the slot leadership schedule:</p>

      <ol>
        <li>Using a terminal window on the computer operating as the block producer in your stake pool configuration, type the following commands to create a folder for saving the results of slot leadership queries:
          <CodeBlock language="bash">
            {`cd $NODE_HOME
mkdir ./schedule`}
          </CodeBlock>
        </li>
        <li>To retrieve the value of the <code>$NODE_HOME</code> environment variable, type:
          <CodeBlock language="bash">
            {`echo $NODE_HOME`}
          </CodeBlock>
        </li>
        <li>Using a text editor, copy and paste the following code into a new text file named <code>$NODE_HOME/calculateLeadership.sh</code> setting the required variables as described in the comments at the beginning of the script:
          <CodeBlock language="bash">
            {calculateLeadership}
          </CodeBlock>
        </li>
        <li>Save and close the <code>calculateLeadership.sh</code> file. To set execute permissions for the file, type:
          <CodeBlock language="bash">
            {`chmod +x $NODE_HOME/calculateLeadership.sh`}
          </CodeBlock>
        </li>
      </ol>

      <p class="pi">To create a service that automates querying the slot leadership schedule:</p>

      <ol>
        <li></li>
      </ol>





      



      

    </div>
  );
}

<HTMLContent />


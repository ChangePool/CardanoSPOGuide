---
title: "Calculating Slot Leadership"
sidebar_label: "Calculating Slot Leadership"
slug: /CalculatingSlotLeadership
hide_title: false
hide_table_of_contents: true
sidebar_position: 45
description: ""
---

import React from 'react';

import CodeBlock from '@theme/CodeBlock';

export function HTMLContent() {
  return (
    <div>

      {/* INSERT HTML HERE */}

      <table class="box">
        <tbody>
          <tr>
            <td class="boxLabel"><p class="boxLabel">Challenge<br /><img src="img/BoxChallenge.png" alt="Challenge" /></p></td>
            <td class="boxText"><p class="boxText">If you operate a stake pool in a Testnet environment, then use the <a href="https://docs.cardano.org/cardano-testnets/tools/faucet" target="_blank">Testnets Faucet</a> to receive a delegation to the pool. Receiving a delegation ensures that the pool is elected to produce blocks regularly, facilitating development and testing.</p></td>
          </tr>
        </tbody>
      </table>

      <p>As a stake pool operator, you aim to keep the stake pool that you operate online at all times. However, knowing in advance when the stake pool is elected to produce a block allows you to schedule required maintenance, for example, without missing an opportunity to produce a block.</p>

      <p>Using Cardano CLI, you can query the slots and Coordinated Universal Times (UTCs) when a stake pool that you operate is elected to produce blocks in the current epoch. Within 36 hours of the next epoch starting, you can also query the slots and times when the stake pool is elected to produce blocks in the next epoch.</p>

      <p><i>Figure 1</i> illustrates how the Cardano protocol shares with stake pool operators the slot leadership schedule for block production, as well as how stake pools prepare blocks.</p>

      <figure>
        <img src="img/BlockProductionProcess.png" />
        <figcaption>Figure 1 Cardano Block Production Process</figcaption>
      </figure>

      <table class="box">
        <tbody>
          <tr>
            <td class="boxLabel"><p class="boxLabel">Note<br /><img src="img/BoxNote.png" alt="Note" /></p></td>
            <td class="boxText"><p class="boxText">In the following procedures, if you are querying the slot leadership schedule for a stake pool operating in a Testnet environment, then replace the <code>--mainnet</code> option with <code>--testnet-magic &lt;MagicNumber&gt;</code> where <code>&lt;MagicNumber&gt;</code> is the network magic number for the Testnet that you use.</p></td>
          </tr>
        </tbody>
      </table>

      <p class="pi">To query the slots and times when a stake pool you operate is elected to produce blocks in the current epoch:</p>
      
      <ul class="ss">
        <li>Using a terminal window on the block-producing node, type:
          <CodeBlock language="bash">
            {`cardano-cli conway query leadership-schedule --output-json \\
  --cardano-mode \\
  --mainnet \\
  --genesis $NODE_HOME/shelley-genesis.json \\
  --stake-pool-id $(cat $NODE_HOME/stakepoolid-bech32.txt) \\
  --vrf-signing-key-file $NODE_HOME/vrf.skey \\
  --current`}
          </CodeBlock>
        </li>
      </ul>

      <table class="box">
        <tbody>
          <tr>
            <td class="boxLabel"><p class="boxLabel">Note<br /><img src="img/BoxNote.png" alt="Note" /></p></td>
            <td class="boxText"><p class="boxText">Depending on available computing resources, the <code>query leadership-schedule</code> command may run for a few minutes prior to displaying results.</p></td>
          </tr>
        </tbody>
      </table>

      <p class="pi">To query the slots and times when a stake pool you operate is elected to produce blocks in the next epoch:</p>
      
      <ul class="ss">
        <li>Using a terminal window on the block-producing node, type the following command within 36 hours of the next epoch starting:
          <CodeBlock language="bash">
            {`cardano-cli conway query leadership-schedule --output-json \\
  --cardano-mode \\
  --mainnet \\
  --genesis $NODE_HOME/shelley-genesis.json \\
  --stake-pool-id $(cat $NODE_HOME/stakepoolid-bech32.txt) \\
  --vrf-signing-key-file $NODE_HOME/vrf.skey \\
  --next`}
          </CodeBlock>
        </li>
      </ul>

      <p>The following example shows you the JSON output format of a <code>query leadership-schedule</code> command:</p>

      <CodeBlock language="json">
        {`[
    {
        "slotNumber": 94264420,
        "slotTime": "2025-10-20T00:33:40Z"
    },
    {
        "slotNumber": 94266557,
        "slotTime": "2025-10-20T01:09:17Z"
    },
    {
        "slotNumber": 94276787,
        "slotTime": "2025-10-20T03:59:47Z"
    },
    {
        "slotNumber": 94277515,
        "slotTime": "2025-10-20T04:11:55Z"
    },
    {
        "slotNumber": 94318072,
        "slotTime": "2025-10-20T15:27:52Z"
    }
]`}
      </CodeBlock>

      <h1>Automating Slot Leadership Calculation</h1>

      <p>TO-DO: Create a script that starts by polling the slot in epoch metric, and then waiting until the time is within 36 hours of the next epoch starting. After waiting, calculate slot leadership for the next epoch. Append the results of the query to a JSON-format file, and then loop.</p>

      <p>TO-DO: Also, update the nodeView.sh script to query the JSON-format file, and then display Pending Blocks, Next Block and Countdown as described in the comments below.</p>



      



      {/* <!-- To monitor slot leadership, create a bash script running as a service that polls the cardano.node.metrics.slotInEpoch.int metric every six hours, or until the slot in epoch is greater than 310,000 Use the VE2.sh script as reference. When slotInEpoch > 310,000 run a slot leader check using cardano-cli and then append the results to a JSON file.
       
      Update the nodeView dashboard to read the JSON file, and then display Pending Blocks (as an integer), Next Block (as a date and time) and Countdown (in terms of time remaining until the next block is prepared) statistics as the first row in the Block Production area. Provide the revisions to the nodeView.sh script relatively, as lines to add. Write the functionality to read the JSON file and prepare the statistics as a function, then call the function, and then display the statistics.
      
      Develop, test and use the script on a day-to-day basis using a Testnet environment. --> */}



      

    </div>
  );
}

<HTMLContent />


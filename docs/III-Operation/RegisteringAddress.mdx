---
title: "Registering Your Stake Address"
sidebar_label: "Registering Your Stake Address"
slug: /RegisteringAddress
hide_title: false
hide_table_of_contents: true
sidebar_position: 25
description: ""
---

import React from 'react';

import TestnetNote from '@site/src/components/TestnetNote.js';

import CodeBlock from '@theme/CodeBlock';
import saveParameters from '!!raw-loader!/txt/saveParameters.sh';
import queryTip from '!!raw-loader!/txt/queryTip.sh';
import tallyUTXOs from '!!raw-loader!/txt/tallyUTXOs.sh';
import calculateFee from '!!raw-loader!/txt/calculateFee.sh';
import signTransaction from '!!raw-loader!/txt/signTransaction.sh';
import submitTransaction from '!!raw-loader!/txt/submitTransaction.sh';

export function HTMLContent() {

  // Replace placeholders in the imported calculateFee component with values
  var calculateFeeRegisteringAddress = calculateFee.replace("{{witness-count}}", "2");

  // Replace placeholder in the imported signTransaction component with values
  var signTransactionRegisteringAddress = signTransaction.replace("{{signing-key-files}}", "--signing-key-file payment.skey \\\n  --signing-key-file stake.skey \\\n  ");

  return (
    <div>

      {/* INSERT HTML HERE */}

      <p>In the Cardano ecosystem, you must register on the blockchain the stake address associated with a payment address containing funds that you plan to stake or pledge.</p>

      <p>Therefore, you need to create a transaction registering the stake address associated with the payment address containing funds that you plan to pledge to your stake pool.</p>

      <p><i>Figure 1</i> provides an overview of the process to prepare and submit a transaction using the Cardano Command Line Interface (CLI).</p>

      <figure>
        <img src="img/TransactionOverview.png" />
        <figcaption>Figure 1 Creating a Transaction using Cardano CLI</figcaption>
      </figure>

      <TestnetNote />

      <p class="pi">To register a stake address on the blockchain:</p>

      <ol>
        <li>On the block-producing node, using a terminal window type the following commands to save protocol parameters in a file using JSON format:
          <CodeBlock language="bash">
            {saveParameters}
          </CodeBlock>
        </li>
        <li>To retrieve the amount in Lovelace of the deposit required to register a stake address, type:
          <CodeBlock language="bash">
            {`stakeAddressDeposit=$(cat $NODE_HOME/params.json | jq -r '.stakeAddressDeposit')
echo stakeAddressDeposit: $\{stakeAddressDeposit\}`}
          </CodeBlock>
        </li>
        <li>To create a stake address registration certificate, type:
          <CodeBlock language="bash">
            {`cardano-cli conway stake-address registration-certificate \\
  --stake-verification-key-file stake.vkey \\
  --key-reg-deposit-amt $\{stakeAddressDeposit\} \\
  --out-file $NODE_HOME/stake.cert`}
          </CodeBlock>
        </li>
        <li>To query the slot number of the current tip of the ledger, type:
          <CodeBlock language="bash">
            {queryTip}
          </CodeBlock>
          <table class="box">
            <tbody>
              <tr>
                <td class="boxLabel"><p class="boxLabel">Note<br /><img src="img/BoxNote.png" alt="Note" /></p></td>
                <td class="boxText"><p class="boxText">The <code>cardano-cli conway query tip</code> command uses the <code>CARDANO_NODE_SOCKET_PATH</code> environment variable that you set in the <code>$HOME/.bashrc</code> file when <a href="/GHC">Installing GHC and Cabal</a>. <code>cardano-cli</code> commands throughout the <i>How to Set Up a Cardano Stake Pool</i> guide may use the <code>CARDANO_NODE_SOCKET_PATH</code> environment variable. If you do not set the <code>CARDANO_NODE_SOCKET_PATH</code> environment variable, then you need to set the <code>--socket-path</code> option explicitly in each command requiring the location of the Cardano Node socket file.</p></td>
              </tr>
            </tbody>
          </table>
        </li>
        <li>To retrieve the UTXOs available for your payment address and calculate the balance, type:
          <CodeBlock language="bash">
            {tallyUTXOs}
          </CodeBlock>
        </li>
        <li>To build a draft transaction for calculating the transaction fee, type:
          <CodeBlock language="bash">
            {`cardano-cli conway transaction build-raw \\
  $\{tx_in\} \\
  --tx-out $(cat $NODE_HOME/payment.addr)+$(( $\{total_balance\} - 200000 - $\{stakeAddressDeposit\} )) \\
  --invalid-hereafter $(( $\{currentSlot\} + 10000 )) \\
  --fee 200000 \\
  --certificate-file $NODE_HOME/stake.cert \\
  --out-file $NODE_HOME/tx.tmp`}
          </CodeBlock>
          <table class="box">
            <tbody>
              <tr>
                <td class="boxLabel"><p class="boxLabel">Note<br /><img src="img/BoxNote.png" alt="Note" /></p></td>
                <td class="boxText"><p class="boxText">The <code>--invalid-hereafter</code> option sets the slot when the transaction expires. The above transaction expires 10,000 seconds—about 2 hours and 45 minutes—after the current slot.</p></td>
              </tr>
            </tbody>
          </table>
        </li>
        <li>To calculate the fee for the transaction in Lovelace, type:
          <CodeBlock language="bash">
            {calculateFeeRegisteringAddress}
          </CodeBlock>
          <table class="box">
            <tbody>
              <tr>
                <td class="boxLabel"><p class="boxLabel">Note<br /><img src="img/BoxNote.png" alt="Note" /></p></td>
                <td class="boxText"><p class="boxText">The <code>--witness-count</code> option indicates the number of keys signing the transaction. You must sign a transaction submitting a stake address registration certificate to the blockchain using the secret—private—key for the payment address spending the input, as well as the secret key for the stake address to register.</p></td>
              </tr>
            </tbody>
          </table>
        </li>
        <li>To calculate change from the transaction, type:
          <CodeBlock language="bash">
            {`txOut=$(($\{total_balance\}-$\{fee\}-$\{stakeAddressDeposit\}))
echo Change: $\{txOut\}`}
          </CodeBlock>
          <table class="box">
            <tbody>
              <tr>
                <td class="boxLabel"><p class="boxLabel">Note<br /><img src="img/BoxNote.png" alt="Note" /></p></td>
                <td class="boxText"><p class="boxText">If change from the transaction is less than 1₳ then funds are insufficient. Transactions having insufficient funds fail when submitted to the network.</p></td>
              </tr>
            </tbody>
          </table>
        </li>
        <li>To build the transaction, type:
          <CodeBlock language="bash">
            {`cardano-cli conway transaction build-raw \\
  $\{tx_in\} \\
  --tx-out $(cat $NODE_HOME/payment.addr)+$\{txOut\} \\
  --invalid-hereafter $(( $\{currentSlot\} + 10000 )) \\
  --fee $\{fee\} \\
  --certificate-file $NODE_HOME/stake.cert \\
  --out-file $NODE_HOME/tx.raw`}
          </CodeBlock>
        </li>
        <li>Copy the <code>tx.raw</code> file that you created in step 9 to the <code>$NODE_HOME</code> folder on your air-gapped, offline computer, and then using a terminal window type the following commands to sign the transaction:
          <CodeBlock language="bash">
            {signTransactionRegisteringAddress}
          </CodeBlock>
        </li>
        <li>Copy the <code>tx.signed</code> file that you created in step 10 to the <code>$NODE_HOME</code> folder on the block-producing node, and then using a terminal window type the following command to submit the transaction to the network:
          <CodeBlock language="bash">
            {submitTransaction}
          </CodeBlock>
        </li>
      </ol>

      <table class="box">
        <tbody>
          <tr>
            <td class="boxLabel"><p class="boxLabel">Challenge<br /><img src="img/BoxChallenge.png" alt="Challenge" /></p></td>
            <td class="boxText"><p class="boxText">To display a draft, unsigned or signed transaction in a human-readable format, type the following command where <code>&lt;TransactionFileName&gt;</code> is the path to the transaction file that you want to inspect:
              <CodeBlock language="bash">
                {`cardano-cli debug transaction view --tx-file <TransactionFileName>`}
              </CodeBlock>
            </p></td>
          </tr>
        </tbody>
      </table>

      <h1>Additional Resources</h1>

      <p>For more details on creating transactions, see <a href="https://docs.cardano.org/developer-resources/transaction-tutorials" target="_blank">Transaction Tutorials</a> and <a href="https://developers.cardano.org/docs/get-started/cardano-cli/basic-operations/get-started" target="_blank">Getting Started with Cardano CLI</a>.</p>

    </div>
  );
}

<HTMLContent />

